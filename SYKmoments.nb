ClearAll; Clear[g4, t4, mo4, mo6, mo6a, tabc, cu6, cu6a, t8, t6c6, \
mo8, qr, d, n, q];
Clear[emx, sc, qr, erhoex, rhoex, rhoapp, et, tan1b]
emx[eta_, sig_] := 4*sig^2/(1 - eta);
rhocc[en_, eta_, sig_, npr_] := 
  Sqrt[1 - en^2/emx[eta, sig]]*
   Product[1 - en^2*4/emx[eta, sig]/(eta^n + 1/eta^n + 2), {n, 1, 
     npr}];
rhocc[en_, eta_, sig_, npr_] := 
  Sqrt[1 - en^2/emx[eta, sig]]*
   Product[1 - en^2*4/emx[eta, sig]/(eta^n + 1/eta^n + 2), {n, 1, 
     npr}];
rhocc2[en_, eta_, e0_, npr_] := 
  Sqrt[1 - en^2/e0^2]*
   Product[1 - en^2*4/e0^2/(eta^n + 1/eta^n + 2), {n, 1, npr}];
sc[N_, q_] := 
 Sum[(-1)^(q - m)*Binomial[N, q]*Binomial[q, m]*
   Binomial[N - q, q - m], {m, 0, q}]
qr[N_, q_] := sc[N, q]/(Binomial[N, q])^2;
t4q[d_, q_] := 
  Sum[Binomial[d - q, r]*Binomial[q, r]*(-1)^(r), {r, 0, q}];
mo4[d_, q_] := 2*(Binomial[d, q])^2 + Binomial[d, q]*t4q[d, q];
t4qc[d_, q_, nc_] := 
  Sum[Binomial[d - q, r]*Binomial[q, r]*(-1)^(r), {r, 0, q}];
mo4c[d_, q_, nc_] := 
  2*(Binomial[d, q])^2 + Binomial[d, q]*t4qc[d, q, nc];
et[n_, q_] := 
  1/Binomial[n, q]*
   Sum[(-1)^(q + r)*Binomial[q, r]*Binomial[n - q, q - r], {r, 0, 
     q}];
etaexp[n_, q_] := (-1)^q (1 - 2 q^2/n + 2 q^2 (q - 1)^2/n^2);
Clear[momqh, q, p, d];
momqh[d_, q_, p_] := 
  1/(1 - et[d, q])^p * 
   Sum[(-1)^k*et[d, q]^(k*(k - 1)/2)*Binomial[2*p, p + k], {k, -p, p}];

(*Single traces up to 8th moment*)

momrt[et_, p_] := 
 1/(1 - et)^p * 
  Sum[(-1)^k*et^(k*(k - 1)/2)*Binomial[2*p, p + k], {k, -p, p}]; 
mo6a[d_, q_, a0_, a4_, a44_, a6_] := 
 5*a0*(Binomial[d, q])^3 + 6*a4*(Binomial[d, q])^2*t4q[d, q] + 
  3*a44*Binomial[d, q]*(t4q[d, q])^2 + a6*tabct[d, q];
Bn[d_, q_] := Binomial[d, q];
Bn1[d_, q_] := d!/q!/(d - q)!;
mo8[d_, q_, a0_, a4_, a44_, a444_, a4444_, a6_, a46_, a6c_, a8_] := 
  14*Bn[d, q]^4 *a0 + 28*a4*Bn[d, q]^3*t4q[d, q] + 
   28*a44*Bn[d, q]^2*t4q[d, q]^2 + 8*Bn[d, q]*a6*tabct[d, q] + 
   12*a444*Bn[d, q]*t4q[d, q]^3 + 
   2*a4444*t6c6nc[d, q]*Binomial[d, q] + a46*8*t4q[d, q]*tabct[d, q] +
    a6c*4*t6c6[d, q]*Bn[d, q] + a8*tan1[d, q];

tabct[d_, q_] := 
  Binomial[d, 
    q]*(Sum[Sum[
      Sum[ (-1)^(q1 + m + q)*Binomial[d - 2*q + q1, q - l]*
        Binomial[2*q - 2*q1, m]*Binomial[d - q, q - q1]*
        Binomial[q, q1]*Binomial[q1, l - m] , {m, 0, l}], {l, 0, 
       q}]   , {q1, 0, q}]
      );
t6c6[d_, q_] := Sum[Sum[Sum[Sum[Sum[ (-1)^(q1 + m + m1 + q)*
        Binomial[d - 2*q + q1, q - l]*Binomial[2*q - 2*q1, m]*
        Binomial[q1, l - m]*Binomial[d - 2*q + q1, q - l1]*
        Binomial[2*q - 2*q1, m1]*Binomial[q1, l1 - m1]*
        Binomial[d - q, q - q1]*Binomial[q, q1] , {m, 0, l}], {l, 0, 
       q}], {m1, 0, l1}], {l1, 0, q}]   , {q1, 0, q}];
t6c6nc[d_, q_] := Sum[Sum[Sum[Sum[Sum[ (-1)^(m + m1)*
        Binomial[d - 2*q + q1, q - l]*Binomial[2*q - 2*q1, m]*
        Binomial[q1, l - m]*Binomial[d - 2*q + q1, q - l1]*
        Binomial[2*q - 2*q1, m1]*Binomial[q1, l1 - m1]*
        Binomial[d - q, q - q1]*Binomial[q, q1] , {m, 0, l}], {l, 0, 
       q}], {m1, 0, l1}], {l1, 0, q}]   , {q1, 0, q}];
t6c6p[d_, q_] := 
  Sum[Sum[Sum[
     Sum[Sum[ 
       N[Binomial[d - 2*q + q1, q - l]*Binomial[2*q - 2*q1, m]*
         Binomial[q1, l - m]*Binomial[d - 2*q + q1, q - l1]*
         Binomial[2*q - 2*q1, m1]*Binomial[q1, l1 - m1]*
         Binomial[d - q, q - q1]*Binomial[q, q1] ], {m, 0, l}], {l, 0,
        q}], {m1, 0, l1}], {l1, 0, q}]   , {q1, 0, q}];
  
t8[d_, q_] := 
  Bn[d, q]*Sum[
    Sum[Sum[Sum[
       Sum[Sum[N[(-1)^(r + m2 + k2 + s + q)*HeavisideTheta[d - q]*
           HeavisideTheta[d - 2*q + r]*
           HeavisideTheta[d - 3*q + r + m1 + m2]*
           Binomial[d - q, q - r]*Binomial[q, r]*
           Binomial[2*q - 2*r, m2]*Binomial[d - 2*q + r, q - m1 - m2]*
           Binomial[r, m1]*Binomial[2*q - 2*r, k2]*Binomial[r, k1]*
           Binomial[q - m1 - m2, s]*
           Binomial[d - 3*q + r + m1 + m2, q - s - k1 - k2]], {s, 0, 
          q - m1 - m2}], {m1, 0, r}], {m2, 0, q}], {k1, 0, r}], {k2, 
      0, q}], {r, 0, q}] ;
t8p[d_, q_] := 
  Bn[d, q]*Sum[
    Sum[Sum[Sum[
       Sum[Sum[Binomial[d - q, q - r]*Binomial[q, r]*
          Binomial[2*q - 2*r, m2]*Binomial[d - 2*q + r, q - m1 - m2]*
          Binomial[r, m1]*Binomial[2*q - 2*r, k2]*Binomial[r, k1]*
          Binomial[q - m1 - m2, s]*
          Binomial[d - 3*q + r + m1 + m2, q - s - k1 - k2], {s, 0, 
          q - m1 - m2}], {m1, 0, q - m2}], {m2, 0, q}], {k1, 0, 
       r}], {k2, 0, q}], {r, 0, q}] ;

tan1[d_, q_] := 
  Bn[d, q]*Sum[
    Sum[Sum[Sum[
       Sum[Sum[Sum[
          Sum[(-1)^(q1 + q2 + m2 + t)*Bn[d - q, q - q1]*Bn[q, q1]*
            Bn[2*q - 2*q1, m2]*Bn[q1, m1]*Bn[m1, m1 - l1]*
            Bn[m2, m2 - l2]*
            Bn[d - 2*q + q1, q - (m1 - l1 + m2 - l2)]*
            Bn[m1 - l1, s]*Bn[m2 - l2, t]*
            Bn[q - (m1 - l1 + m2 - l2), q2 - s - t]
            *
            Bn[d - 3*q + q1 + m1 - l1 + m2 - l2, 
             q - (q2 + l1 + l2)], {s, 0, m1 - l1}], {t, 0, m2 - l2}],
         {l1, 0, m1}], {l2, 0, m2}], {m1, 0, q1}], {m2, 0, 
       2*q - 2*q1}], {q1, 0, q}], {q2, 0, q}];
Ftan1[d_, q_, q1_, q2_, m1_, m2_, l1_, l2_, s_, t_] := 
  Bn[d, q]*(-1)^(q1 + q2 + m2 + t)*Bn[d - q, q - q1]*Bn[q, q1]*
   Bn[2*q - 2*q1, m2]*Bn[q1, m1]*Bn[m1, m1 - l1]*Bn[m2, m2 - l2]*
   Bn[d - 2*q + q1, q - (m1 - l1 + m2 - l2)]*
   Bn[m1 - l1, s]*Bn[m2 - l2, t]*
   Bn[q - (m1 - l1 + m2 - l2), q2 - s - t]*
   Bn[d - 3*q + q1 + m1 - l1 + m2 - l2, q - (q2 + l1 + l2)];
tan1ap[d_, q_] := 
  Bn[d, q]*Sum[
    Sum[Sum[Sum[
       Sum[Sum[Sum[
          Sum[(-1)^(0*(q1 + q2 + m2 + t))*Bn[d - q, q - q1]*
            Bn[q, q1]*
            Bn[2*q - 2*q1, m2]*Bn[q1, m1]*Bn[m1, m1 - l1]*
            Bn[m2, m2 - l2]*
            Bn[d - 2*q + q1, q - (m1 - l1 + m2 - l2)]*
            Bn[m1 - l1, s]*Bn[m2 - l2, t]*
            Bn[q - (m1 - l1 + m2 - l2), q2 - s - t]
            *
            Bn[d - 3*q + q1 + m1 - l1 + m2 - l2, 
             q - (q2 + l1 + l2)], {s, 0, m1 - l1}], {t, 0, m2 - l2}],
         {l1, 0, m1}], {l2, 0, m2}], {m1, 0, q1}], {m2, 0, 
       2*q - 2*q1}], {q1, 0, q}], {q2, 0, q}];
tan1b[d_, q_] := 
  Bn[d, q]*Sum[
    Sum[Sum[Sum[
       Sum[Sum[Sum[
          Sum[(-1)^(q1 + q2 + m2 + t)*Bn[d - q, q - q1]*Bn[q, q1]*
            Bn[2*q - 2*q1, m2]*Bn[q1, m1]*Bn[m1, s]*
            Bn[m1 - s, l1 - s]*Bn[m2, t]*Bn[m2 - t, l2 - t]*
            Bn[d - 2*q + q1, 2*q - q2 - m1 - m2]*
            Bn[2*q - q2 - m1 - m2, q2 - s - t]*
            Bn[2*q - 2*q2 - m1 - m2 + s + t, 
             q - q2 - m1 - m2 + l1 + l2], {s, 0, l1}], {t, 0, l2}],
         {l1, 0, q}], {l2, 0, q}], {m1, 0, q1}], {m2, 0, 
       2*q - 2*q1}], {q1, 0, q}], {q2, 0, q}];
tan1d[d_, q_] := 
  Bn[d, q]*Sum[
    Sum[Sum[Sum[
       Sum[Sum[Sum[(-1)^(q1 + q2 + m2 + t)*Bn[d - q, q - q1]*Bn[q, q1]*
           Bn[2*q - 2*q1, m2]*Bn[q1, m1]*Bn[m1, s]*
           Bn[m1 + m2 - s - t, l - s - t]*Bn[m2, t]*
           Bn[d - 2*q + q1, 2*q - q2 - m1 - m2]*
           Bn[2*q - q2 - m1 - m2, q2 - s - t]*
           Bn[2*q - 2*q2 - m1 - m2 + s + t, q - q2 - m1 - m2 + l], {s,
            0, q}], {t, 0, q}],
        {l, 0, q}], {m1, 0, q1}], {m2, 0, 2*q - 2*q1}], {q1, 0, 
      q}], {q2, 0, q}];
tan1e[d_, q_] := 
  Bn[d, q]*Sum[
    Sum[Sum[Sum[
       Sum[Sum[(-1)^(q1 + q2 + m2 + t)*Bn[d - q, q - q1]*Bn[q, q1]*
          Bn[2*q - 2*q1, m2]*Bn[q1, m1]*Bn[m1, s]*Bn[m2, t]*
          Bn[d - 2*q + q1, 2*q - q2 - m1 - m2]*
          Bn[2*q - q2 - m1 - m2, q2 - s - t]*
          Bn[2*q - 2*q2, q - q2], {s, 0, q}], {t, 0, q}],
       {m1, 0, q1}], {m2, 0, 2*q - 2*q1}], {q1, 0, q}], {q2, 0, q}];
tan1f[d_, q_] := 
  Bn[d, q]*Sum[
    Sum[Sum[Sum[
       Sum[(-1)^(q1 + q2 + m2 + t)*Bn[d - q, q - q1]*Bn[q, q1]*
         Bn[2*q - 2*q1, m2]*Bn[q1, m1]*Bn[m2, t]*
         Bn[d - 2*q + q1, 2*q - q2 - m1 - m2]*
         Bn[2*q - q2 - m2, q2 - t]*Bn[2*q - 2*q2, q - q2], {t, 0, 
         q}],
       {m1, 0, q1}], {m2, 0, 2*q - 2*q1}], {q1, 0, q}], {q2, 0, q}];
tan1g[d_, q_] := 
  Bn[d, q]*Sum[
    Sum[Sum[Sum[(-1)^(q1 + q2 + m2 + t)*Bn[d - q, q - q1]*Bn[q, q1]*
        Bn[2*q - 2*q1, m2]*Bn[m2, t]*
        Bn[d - 2*q + 2 q1, 2*q - q2 - m2]*Bn[2*q - q2 - m2, q2 - t]*
        Bn[2*q - 2*q2, q - q2], {t, 0, q}],
      {m2, 0, 2*q - 2*q1}], {q1, 0, q}], {q2, 0, q}];
tan1c[d_, q_] := 
  Bn[d, q]*Sum[
    Sum[Sum[Sum[
       Sum[(-1)^(q1 + q2 + m2 + t)*Bn[d - q, q - q1]*Bn[q, q1]*
         Bn[2*q - 2*q1, m2]*Bn[q1, m1]*
         Bn[2*q - 2*q2, q - q2]*Bn[d - 2*q + q1, 2*q - q2 - m1 - m2]*
         Bn[2*q - q2 - m2, q2 - t]*Bn[m2, t], {t, 0, q}],
       {m1, 0, q}], {m2, 0, q}], {q1, 0, q}], {q2, 0, q}];
tan1p[d_, q_] := 
  Bn[d, q]*Sum[Sum[Sum[Sum[Sum[Sum[Sum[Sum[Bn[d - q, q - q1]*Bn[q, q1]*
            Bn[2*q - 2*q1, m2]*Bn[q1, m1]*Bn[m1, m1 - l1]*
            Bn[m2, m2 - l2]*
            Bn[d - 2*q + q1, q - (m1 - l1 + m2 - l2)]*
            Bn[m1 - l1, s]*Bn[m2 - l2, t]*
            Bn[q - (m1 - l1 + m2 - l2), q2 - s - t]
            *
            Bn[d - 3*q + q1 + m1 - l1 + m2 - l2, 
             q - (q2 + l1 + l2)], {s, 0, m1 - l1}], {t, 0, m2 - l2}],
         {l1, 0, m1}], {l2, 0, m2}], {m1, 0, q1}], {m2, 0, 
       2*q - 2*q1}], {q1, 0, q}], {q2, 0, q}];
tan1smp[d_, q_] := 
  Bn[d, q]*Sum[(-1)^(q + q1 + m2 + s2)*Bn[d - q, q - q1]*Bn[q, q1]*
     Bn[2*q - 2*q1, m2]*Bn[q1, m1]*
     Bn[m2, k2]*Bn[k2, s2]*Bn[d - 2*q + q1 + m1, q - k2]*
     Bn[d - 2*q + q1 - k2, q - s2 - (m1 + m2)], {q1, 0, q}, {m1, 0, 
     q1}, {m2, 0, 2*q - 2*q1}, {k2, 0, m2}, {s2, 0, k2}];
mom8[d_, q_] := 
  mo8[d, q, 1, 1, 1, 1, 1, 1, 1, 1, 1]/Binomial[d, q]^4;
mom6[d_, q_] := mo6a[d, q, 1, 1, 1, 1]/Binomial[d, q]^3;
mom4[d_, q_] := mo4[d, q]/Binomial[d, q]^2;
cu4[d_, q_] := mom4[d, q] - 3;
cu6[d_, q_] := mom6[d, q] - 15 mom4[d, q] + 30;
cu8[d_, q_] := 
  mom8[d, q] - 28 mom6[d, q] - 35 mom4[d, q]^2 + 420 mom4[d, q] - 
   630;
cu4o[d_, q_] := mom4[d, q] - 1;
cu6o[d_, q_] := mom6[d, q] - 3 mom4[d, q] + 2;
cu8o[d_, q_] := 
  mom8[d, q] - 4 mom6[d, q] - 3 mom4[d, q]^2 + 12 mom4[d, q] - 6;

t6c6p[24, 4]/Binomial[24, 4]^3;

(*Double traces up to <Tr H^6 Tr H^6>*)
testFromCotlerAppenF[n_, q_, k_] := 
  2^(-n) Binomial[n, q]^(-k) Sum[
    Binomial[n, 
      m] (Sum[Binomial[m, p] Binomial[n - m, q - p] (-1)^p, {p, 0, 
         q}])^k, {m, 0, n}];
t123123[n_, q_] := 
  t123123[n, q] = Binomial[n, q]^(-3) n!/(n - 3 q/2)! 1/(q/2)!^3;

sol12341234[q_] := 
  sol12341234[q] = 
   Solve[ab + ac + ad + abcd == q && ab + bc + bd + abcd == q && 
     ac + bc + cd + abcd == q && ad + bd + cd + abcd == q && 
     0 <= ab <= q && 0 <= ac <= q && 0 <= ad <= q && 0 <= bc <= q && 
     0 <= bd <= q && 0 <= cd <= q && 0 <= abcd <= q, {ab, ac, ad, bc, 
     bd, cd, abcd}, Integers];
t12341234[n_, q_] := 
  t12341234[n, q] = 
   Module[{d2, d3, d4}, d2 = ab + ac + ad + bc + bd + cd;
    d4 = abcd;
    Binomial[n, q]^(-4) Sum[
      n!/(n - 4 q + d2 + 3 d4)! 1/(ab! ac! ad! bc! bd! cd! abcd!) /. 
       sol12341234[q][[i]], {i, 1, Length[sol12341234[q]]}]];

t12341243[n_, q_] := 
  t12341243[n, q] = 
   Module[{d2, d3, d4}, d2 = ab + ac + ad + bc + bd + cd;
    d4 = abcd;
    (-1)^q Binomial[n, 
       q]^(-4) Sum[(-1)^(cd + abcd) n!/(n - 4 q + d2 + 3 d4)! 1/(
        ab! ac! ad! bc! bd! cd! abcd!) /. sol12341234[q][[i]], {i, 1, 
       Length[sol12341234[q]]}]];
t12341234test[n_, q_] := 
  Module[{d2, d3, d4}, d2 = ab + ac + ad + bc + bd + cd;
   d4 = abcd;
   Binomial[n, q]^(-4) Sum[
     n!/(n - 2 q + 
         d4)! 1/((bd!)^2 (cd!)^2 ((q - abcd - bd - 
           cd)!)^2 abcd!), {bd, 0, q}, {cd, 0, q - bd}, {abcd, 0, 
      q - bd - cd}]];
(*note the difference in the summation limits of abcd*)
t12341234testwrong[n_, q_] := 
  Module[{d2, d3, d4}, d2 = ab + ac + ad + bc + bd + cd;
   d4 = abcd;
   Binomial[n, q]^(-4) Sum[
     n!/(n - 2 q + 
         d4)! 1/((bd!)^2 (cd!)^2 ((q - abcd - bd - 
           cd)!)^2 abcd!), {bd, 0, q}, {cd, 0, q}, {abcd, 0, q}]];

t12341243test[n_, q_] := 
  Module[{d2, d3, d4}, d2 = ab + ac + ad + bc + bd + cd;
   d4 = abcd;
   (-1)^q Binomial[n, 
      q]^(-4) Sum[(-1)^(cd + abcd) n!/(n - 2 q + 
         d4)! 1/((bd!)^2 (cd!)^2 ((q - abcd - bd - 
           cd)!)^2 abcd!), {bd, 0, q}, {cd, 0, q - bd}, {abcd, 0, 
      q - bd - cd}]];
sol1234ee1234[q_] := 
  sol1234ee1234[q] = 
   Solve[ab + ac + ad + abe + ace + ade + abcd + abcde == q && 
     ab + bc + bd + abe + bce + bde + abcd + abcde == q && 
     ac + bc + cd + ace + bce + cde + abcd + abcde == q && 
     ad + bd + cd + ade + bde + cde + abcd + abcde == q && 
     0 <= ab <= q && 0 <= ac <= q && 0 <= ad <= q && 0 <= bc <= q && 
     0 <= bd <= q && 0 <= cd <= q && 0 <= abe <= q && 0 <= ace <= q &&
      0 <= ade <= q && 0 <= bce <= q && 0 <= bde <= q && 
     0 <= cde <= q && 0 <= abcd <= q && 0 <= abcde <= q, {ab, ac, ad, 
     bc, bd, cd, abe, ace, ade, bce, bde, cde, abcd, abcde}, Integers];
t1234e12e34[n_, q_] := 
  t1234e12e34[n, q] = 
   Module[{d2, d3, d4, d5, aeIntersect, beIntersect}, 
    d2 = ab + ac + ad + bc + bd + cd; 
    d3 = abe + ace + ade + bce + bde + cde;
    d4 = abcd; d5 = abcde;
    aeIntersect = abe + ace + ade + abcde; 
    beIntersect = abe + bce + bde + abcde;
    Binomial[n, 
       q]^(-5) Sum[(-1)^(aeIntersect + beIntersect) n!/(n - 5 q + 
           d2 + 2 d3 + 3 d4 + 4 d5)! 1/(q - abe - ace - ade - bce - 
           bde - cde - abcde)! 1/(ab! ac! ad! bc! bd! cd!) 1/(
        abe! ace! ade! bce! bde! cde!) 1/abcd! 1/abcde! /. 
       sol1234ee1234[q][[i]], {i, 1, Length[sol1234ee1234[q]]}]];

t1234e12e43[n_, q_] := 
  t1234e12e43[n, q] = 
   Module[{d2, d3, d4, d5, aeIntersect, beIntersect, cdIntersect}, 
    d2 = ab + ac + ad + bc + bd + cd; 
    d3 = abe + ace + ade + bce + bde + cde;
    d4 = abcd; d5 = abcde;
    aeIntersect = abe + ace + ade + abcde; 
    beIntersect = abe + bce + bde + abcde; 
    cdIntersect = cd + cde + abcd + abcde;
    (-1)^q Binomial[n, 
       q]^(-5) Sum[(-1)^(aeIntersect + beIntersect + 
           cdIntersect) n!/(n - 5 q + d2 + 2 d3 + 3 d4 + 4 d5)! 1/(q -
            abe - ace - ade - bce - bde - cde - abcde)! 1/(
        ab! ac! ad! bc! bd! cd!) 1/(abe! ace! ade! bce! bde! cde!) 1/
        abcd! 1/abcde! /. sol1234ee1234[q][[i]], {i, 1, 
       Length[sol1234ee1234[q]]}]];

t1234e13e24[n_, q_] := 
  t1234e13e24[n, q] = 
   Module[{d2, d3, d4, d5, aeIntersect, ceIntersect, bcIntersect}, 
    d2 = ab + ac + ad + bc + bd + cd; 
    d3 = abe + ace + ade + bce + bde + cde;
    d4 = abcd; d5 = abcde;
    solsubsti = 
     Solve[ab + ac + ad + abe + ace + ade + abcd + abcde == q && 
       ab + bc + bd + abe + bce + bde + abcd + abcde == q && 
       ac + bc + cd + ace + bce + cde + abcd + abcde == q && 
       ad + bd + cd + ade + bde + cde + abcd + abcde == q && 
       0 <= ab <= q && 0 <= ac <= q && 0 <= ad <= q && 0 <= bc <= q &&
        0 <= bd <= q && 0 <= cd <= q && 0 <= abe <= q && 
       0 <= ace <= q && 0 <= ade <= q && 0 <= bce <= q && 
       0 <= bde <= q && 0 <= cde <= q && 0 <= abcd <= q && 
       0 <= abcde <= q, {ab, ac, ad, bc, bd, cd, abe, ace, ade, bce, 
       bde, cde, abcd, abcde}, Integers];
    aeIntersect = abe + ace + ade + abcde; 
    ceIntersect = ace + bce + cde + abcde; 
    bcIntersect = bc + bce + abcd + abcde;
    (-1)^q Binomial[n, 
       q]^(-5) Sum[(-1)^(aeIntersect + ceIntersect + 
           bcIntersect) n!/(n - 5 q + d2 + 2 d3 + 3 d4 + 4 d5)! 1/(q -
            abe - ace - ade - bce - bde - cde - abcde)! 1/(
        ab! ac! ad! bc! bd! cd!) 1/(abe! ace! ade! bce! bde! cde!) 1/
        abcd! 1/abcde! /. sol1234ee1234[q][[i]], {i, 1, 
       Length[sol1234ee1234[q]]}]];

(*Should equal t12341234*)
t1234ee1234[n_, q_] := 
  t1234ee1234[n, q] = 
   Module[{d2, d3, d4, d5, aeIntersect, beIntersect}, 
    d2 = ab + ac + ad + bc + bd + cd; 
    d3 = abe + ace + ade + bce + bde + cde;
    d4 = abcd; d5 = abcde;
    aeIntersect = abe + ace + ade + abcde; 
    beIntersect = abe + bce + bde + abcde;
    Binomial[n, q]^(-5) Sum[
      n!/(n - 5 q + d2 + 2 d3 + 3 d4 + 4 d5)! 1/(q - abe - ace - ade -
            bce - bde - cde - abcde)! 1/(ab! ac! ad! bc! bd! cd!) 1/(
        abe! ace! ade! bce! bde! cde!) 1/abcd! 1/abcde! /. 
       sol1234ee1234[q][[i]], {i, 1, Length[sol1234ee1234[q]]}]];

(*Should equal \[Eta]*t12341234*)
t1234e1e234[n_, q_] := 
  t1234e1e234[n, q] = 
   Module[{d2, d3, d4, d5, aeIntersect, beIntersect}, 
    d2 = ab + ac + ad + bc + bd + cd; 
    d3 = abe + ace + ade + bce + bde + cde;
    d4 = abcd; d5 = abcde;
    aeIntersect = abe + ace + ade + abcde; 
    beIntersect = abe + bce + bde + abcde;
    (-1)^q Binomial[n, 
       q]^(-5) Sum[(-1)^(aeIntersect) n!/(n - 5 q + d2 + 2 d3 + 
           3 d4 + 4 d5)! 1/(q - abe - ace - ade - bce - bde - cde - 
           abcde)! 1/(ab! ac! ad! bc! bd! cd!) 1/(
        abe! ace! ade! bce! bde! cde!) 1/abcd! 1/abcde! /. 
       sol1234ee1234[q][[i]], {i, 1, Length[sol1234ee1234[q]]}]];

Clear[ab, ac, ad, ae, bc, bd, be, cd, ce, de, abcd, abce, abde, acde, 
  bcde];
sol1234512345[q_] := 
  sol1234512345[q] = 
   Solve[ab + ac + ad + ae + abcd + abce + abde + acde == q && 
     ab + bc + bd + be + abcd + abce + abde + bcde == q && 
     ac + bc + cd + ce + abcd + abce + acde + bcde == q && 
     ad + bd + cd + de + abcd + abde + acde + bcde == q && 
     ae + be + ce + de + abce + abde + acde + bcde == q && 
     0 <= ab <= q && 0 <= ac <= q && 0 <= ad <= q && 0 <= bc <= q && 
     0 <= bd <= q && 0 <= cd <= q && 0 <= ae <= q && 0 <= be <= q && 
     0 <= ce <= q && 0 <= de <= q && 0 <= abcd <= q && 
     0 <= abce <= q && 0 <= abde <= q && 0 <= acde <= q && 
     0 <= bcde <= q, {ab, ac, ad, ae, bc, bd, be, cd, ce, de, abcd, 
     abce, abde, acde, bcde}, Integers];

t1234512345[n_, q_] := 
  t1234512345[n, q] = 
   Module[{d2, d3, d4, d5}, 
    d2 = ab + ac + ad + bc + bd + cd + ae + be + ce + de; d3 = 0;
    d4 = abcd + abce + abde + acde + bcde; d5 = 0;
    Binomial[n, q]^(-5) Sum[
      n!/(n - 5 q + d2 + 2 d3 + 3 d4 + 4 d5)! 1/(
        ab! ac! ad! bc! bd! cd! ae! be! ce! de!) 1/(
        abcd! abce! abde! acde! bcde!) /. sol1234512345[q][[i]], {i, 
       1, Length[sol1234512345[q]]}]];
t1234512345test[n_, q_] := Module[{ab, ac, ad, ae, bc, d2, d3, d4, d5},
   (*ab= acde+ bcde+ cd+ce+de-q/2;ac= abde+ bcde+ bd+be+de-q/2;
   ad=-abcd-abde-acde-bcde-bd-cd-de+q;ae=-abce-abde-acde-bcde-be-ce-
   de+q;bc=-abcd- abce- abde-acde-2 bcde- bd- be-2cd- ce-de+3 q/2;*)
 
     d2 = ab + ac + ad + bc + bd + cd + ae + be + ce + de; d3 = 0;
   d4 = abcd + abce + abde + acde + bcde; d5 = 0;
   Binomial[n, q]^(-5) Sum[
     n!/(n - 5 q + d2 + 2 d3 + 3 d4 + 4 d5)! 1/(
      ab! ac! ad! bc! bd! cd! ae! be! ce! de!) 1/(
      abcd! abce! abde! acde! bcde!), {bd, 0, q}, {be, 0, q}, {cd, 0, 
      q}, {ce, 0, q}, {de, 0, q}, {abcd, 
      0, -abde - acde - bcde - bd - cd - de + q}, {abce, 
      0, -abde - acde - bcde - be - ce - de + q}, {abde, 
      q/2 - bcde - bd - be - de, 
      3 q/2 - ( bcde + bd + be + de)}, {acde, 
      q/2 - bcde - cd - ce - de, 
      3 q/2 - (bcde + cd + ce + de)}, {bcde, 0, 
      3 q/4-- bd - be - 2 cd - ce - de}
     ]];
t1234512354[n_, q_] := 
  t1234512354[n, q] = 
   Module[{d2, d3, d4, d5, deIntersect}, 
    d2 = ab + ac + ad + bc + bd + cd + ae + be + ce + de; d3 = 0;
    d4 = abcd + abce + abde + acde + bcde; d5 = 0;
    deIntersect = de + abde + acde + bcde;
    (-1)^q Binomial[n, 
       q]^(-5) Sum[(-1)^
         deIntersect n!/(n - 5 q + d2 + 2 d3 + 3 d4 + 4 d5)! 1/(
        ab! ac! ad! bc! bd! cd! ae! be! ce! de!) 1/(
        abcd! abce! abde! acde! bcde!) /. sol1234512345[q][[i]], {i, 
       1, Length[sol1234512345[q]]}]];

t1234512453[n_, q_] := 
  t1234512453[n, q] = 
   Module[{d2, d3, d4, d5, cdIntersect, ceIntersect}, 
    d2 = ab + ac + ad + bc + bd + cd + ae + be + ce + de; d3 = 0;
    d4 = abcd + abce + abde + acde + bcde; d5 = 0;
    cdIntersect = cd + abcd + acde + bcde; 
    ceIntersect = ce + abce + acde + bcde;
    Binomial[n, 
       q]^(-5) Sum[(-1)^(ceIntersect + cdIntersect) n!/(n - 5 q + 
           d2 + 2 d3 + 3 d4 + 4 d5)! 1/(
        ab! ac! ad! bc! bd! cd! ae! be! ce! de!) 1/(
        abcd! abce! abde! acde! bcde!) /. sol1234512345[q][[i]], {i, 
       1, Length[sol1234512345[q]]}]];

t1234513524[n_, q_] := 
  t1234513524[n, q] = 
   Module[{d2, d3, d4, d5, bcIntersect, beIntersect, deIntersect}, 
    d2 = ab + ac + ad + bc + bd + cd + ae + be + ce + de; d3 = 0;
    d4 = abcd + abce + abde + acde + bcde; d5 = 0;
    bcIntersect = bc + abcd + abce + bcde; 
    beIntersect = be + abce + abde + bcde; 
    deIntersect = de + acde + abde + bcde;
    (-1)^q Binomial[n, 
       q]^(-5) Sum[(-1)^(bcIntersect + beIntersect + 
           deIntersect) n!/(n - 5 q + d2 + 2 d3 + 3 d4 + 4 d5)! 1/(
        ab! ac! ad! bc! bd! cd! ae! be! ce! de!) 1/(
        abcd! abce! abde! acde! bcde!) /. sol1234512345[q][[i]], {i, 
       1, Length[sol1234512345[q]]}]];
t1234512345another[n_, q_] := 
  Module[{d2, d3, d4, d5, bcIntersect, beIntersect, deIntersect}, 
   d2 = ab + ac + ad + bc + bd + cd + ae + be + ce + de; d3 = 0;
   d4 = abcd + abce + abde + acde + bcde; d5 = 0;
   bcIntersect = bc + abcd + abce + bcde; 
   beIntersect = be + abce + abde + bcde; 
   deIntersect = de + acde + abde + bcde; 
   Binomial[n, q]^(-5) Sum[
     KroneckerDelta[
       ab + ac + ad + ae + abcd + abce + abde + acde - 
        q] KroneckerDelta[
       ab + bc + bd + be + abcd + abce + abde + bcde - 
        q] KroneckerDelta[
       ac + bc + cd + ce + abcd + abce + acde + bcde - 
        q] KroneckerDelta[
       ad + bd + cd + de + abcd + abde + acde + bcde - 
        q] KroneckerDelta[
       ae + be + ce + de + abce + abde + acde + bcde - 
        q] (-1)^(bcIntersect + beIntersect + deIntersect) n!/(n - 
         5 q + d2 + 2 d3 + 3 d4 + 4 d5)! 1/(
      ab! ac! ad! bc! bd! cd! ae! be! ce! de!) 1/(
      abcd! abce! abde! acde! bcde!), {ab, 0, q}, {ac, 0, q}, {ad, 0, 
      q}, {bc, 0, q}, {bd, 0, q}, {cd, 0, q}, {ae, 0, q}, {be, 0, 
      q}, {ce, 0, q}, {de, 0, q}, {abcd, 0, q}, {abce, 0, q}, {abde, 
      0, q}, {acde, 0, q}, {bcde, 0, q}]];

(*Double traces with 6 index sets,  much more run time*)

solee1234ff1234[q_] := solee1234ff1234[q] =
   Solve[ab + ac + ad + abe + ace + ade + abf + acf + adf + abef + 
       acef + adef + abcd + abcde + abcdf + abcdef == q && 
     ab + bc + bd + abe + bce + bde + abf + bcf + bdf + abef + bcef + 
       bdef + abcd + abcde + abcdf + abcdef == q && 
     ac + bc + cd + ace + bce + cde + acf + bcf + cdf + acef + bcef + 
       cdef + abcd + abcde + abcdf + abcdef == q && 
     ad + bd + cd + ade + bde + cde + adf + bdf + cdf + adef + bdef + 
       cdef + abcd + abcde + abcdf + abcdef == q && 0 <= ab <= q && 
     0 <= ac <= q && 0 <= ad <= q && 0 <= bc <= q && 0 <= bd <= q && 
     0 <= cd <= q && 0 <= ef <= q && 0 <= abe <= q && 0 <= ace <= q &&
      0 <= ade <= q && 0 <= bce <= q && 0 <= bde <= q && 
     0 <= cde <= q && 0 <= abf <= q && 0 <= acf <= q && 
     0 <= adf <= q && 0 <= bcf <= q && 0 <= bdf <= q && 
     0 <= cdf <= q && 0 <= abef <= q && 0 <= acef <= q && 
     0 <= adef <= q && 0 <= bcef <= q && 0 <= bdef <= q && 
     0 <= cdef <= q && 0 <= abcd <= q && 0 <= abcde <= q && 
     0 <= abcdf <= q && 0 <= abcdef <= q, {ab, ac, ad, bc, bd, cd, ef,
      abe, ace, ade, bce, bde, cde, abf, acf, adf, bcf, bdf, cdf, 
     abef, acef, adef, bcef, bdef, cdef, abcd, abcde, abcdf, abcdef}, 
    Integers];


(*should equal tt12341234*)
tee123434ff1234[n_, q_] := 
  tee123434ff1234[n, q] = 
   Module[{d2, d3, d4, d5, d6, aeIntersect, beIntersect, afIntersect, 
     bfIntersect}, d2 = ab + ac + ad + bc + bd + cd + ef; 
    d3 = abe + ace + ade + bce + bde + cde + abf + acf + adf + bcf + 
      bdf + cdf;
    d4 = abef + acef + adef + bcef + bdef + cdef + abcd; 
    d5 = abcde + abcdf; d6 = abcdef;
    aeIntersect = 
     abe + ace + ade + abef + acef + adef + abcde + abcdef; 
    beIntersect = 
     abe + bce + bde + abef + bcef + bdef + abcde + abcdef; 
    afIntersect = 
     abf + acf + adf + abef + acef + adef + abcdf + abcdef; 
    bfIntersect = 
     abf + bcf + bdf + abef + bcef + bdef + abcdf + abcdef;
    Binomial[n, q]^(-6) Sum[ 
      n!/(n - 6 q + d2 + 2 d3 + 3 d4 + 4 d5 + 5 d6)! 1/(q - ef - abe -
            ace - ade - bce - bde - cde - abef - acef - adef - bcef - 
           bdef - cdef - abcde - abcdef)! 1/(q - ef - abf - acf - 
           adf - bcf - bdf - cdf - abef - acef - adef - bcef - bdef - 
           cdef - abcdf - abcdef)! 1/(ab! ac! ad! bc! bd! cd! ef!) 1/(
        abe! ace! ade! bce! bde! cde! abf! acf! adf! bcf! bdf! cdf!)
         1/(abcd! abef! acef! adef! bcef! bdef! cdef!) 1/(
        abcde! abcdf!) 1/abcdef! /. solee1234ff1234[q][[i]], {i, 1, 
       Length[solee1234ff1234[q]]}]];

te12e34f12f34[n_, q_] := 
  te12e34f12f34[n, q] = 
   Module[{d2, d3, d4, d5, d6, aeIntersect, beIntersect, afIntersect, 
     bfIntersect}, d2 = ab + ac + ad + bc + bd + cd + ef; 
    d3 = abe + ace + ade + bce + bde + cde + abf + acf + adf + bcf + 
      bdf + cdf;
    d4 = abef + acef + adef + bcef + bdef + cdef + abcd; 
    d5 = abcde + abcdf; d6 = abcdef;
    aeIntersect = 
     abe + ace + ade + abef + acef + adef + abcde + abcdef; 
    beIntersect = 
     abe + bce + bde + abef + bcef + bdef + abcde + abcdef; 
    afIntersect = 
     abf + acf + adf + abef + acef + adef + abcdf + abcdef; 
    bfIntersect = 
     abf + bcf + bdf + abef + bcef + bdef + abcdf + abcdef;
    Binomial[n, 
       q]^(-6) Sum[ (-1)^(aeIntersect + beIntersect + afIntersect + 
           bfIntersect) n!/(n - 6 q + d2 + 2 d3 + 3 d4 + 4 d5 + 
           5 d6)! 1/(q - ef - abe - ace - ade - bce - bde - cde - 
           abef - acef - adef - bcef - bdef - cdef - abcde - 
           abcdef)! 1/(q - ef - abf - acf - adf - bcf - bdf - cdf - 
           abef - acef - adef - bcef - bdef - cdef - abcdf - 
           abcdef)! 1/(ab! ac! ad! bc! bd! cd! ef!) 1/(
        abe! ace! ade! bce! bde! cde! abf! acf! adf! bcf! bdf! cdf!)
         1/(abcd! abef! acef! adef! bcef! bdef! cdef!) 1/(
        abcde! abcdf!) 1/abcdef! /. solee1234ff1234[q][[i]], {i, 1, 
       Length[solee1234ff1234[q]]}]];


te12e34f12f43[n_, q_] := 
  te12e34f12f43[n, q] = 
   Module[{d2, d3, d4, d5, d6, aeIntersect, beIntersect, afIntersect, 
     bfIntersect, cdIntersect}, d2 = ab + ac + ad + bc + bd + cd + ef;
     d3 = abe + ace + ade + bce + bde + cde + abf + acf + adf + bcf + 
      bdf + cdf;
    d4 = abef + acef + adef + bcef + bdef + cdef + abcd; 
    d5 = abcde + abcdf; d6 = abcdef;
    aeIntersect = 
     abe + ace + ade + abef + acef + adef + abcde + abcdef; 
    beIntersect = 
     abe + bce + bde + abef + bcef + bdef + abcde + abcdef; 
    afIntersect = 
     abf + acf + adf + abef + acef + adef + abcdf + abcdef; 
    bfIntersect = 
     abf + bcf + bdf + abef + bcef + bdef + abcdf + abcdef;
    cdIntersect = 
     cd + cde + cdf + cdef + abcd + abcde + abcdf + abcdef;
    (-1)^q Binomial[n, 
       q]^(-6) Sum[ (-1)^(aeIntersect + beIntersect + afIntersect + 
           bfIntersect + cdIntersect) n!/(n - 6 q + d2 + 2 d3 + 
           3 d4 + 4 d5 + 5 d6)! 1/(q - ef - abe - ace - ade - bce - 
           bde - cde - abef - acef - adef - bcef - bdef - cdef - 
           abcde - abcdef)! 1/(q - ef - abf - acf - adf - bcf - bdf - 
           cdf - abef - acef - adef - bcef - bdef - cdef - abcdf - 
           abcdef)! 1/(ab! ac! ad! bc! bd! cd! ef!) 1/(
        abe! ace! ade! bce! bde! cde! abf! acf! adf! bcf! bdf! cdf!)
         1/(abcd! abef! acef! adef! bcef! bdef! cdef!) 1/(
        abcde! abcdf!) 1/abcdef! /. solee1234ff1234[q][[i]], {i, 1, 
       Length[solee1234ff1234[q]]}]];


(* {ab,ac,ad,bc,bd,cd,ef,abe,ace,ade,bce,bde,cde,abf,acf,adf,bcf,bdf,\
cdf,abef,acef,adef,bcef,bdef,cdef,abcd,abcde,abcdf,abcdef}*)

te12e34f13f24[n_, q_] := 
  te12e34f13f24[n, q] = 
   Module[{d2, d3, d4, d5, d6, aeIntersect, beIntersect, afIntersect, 
     bcIntersect, cfIntersect}, d2 = ab + ac + ad + bc + bd + cd + ef;
     d3 = abe + ace + ade + bce + bde + cde + abf + acf + adf + bcf + 
      bdf + cdf;
    d4 = abef + acef + adef + bcef + bdef + cdef + abcd; 
    d5 = abcde + abcdf; d6 = abcdef;
    aeIntersect = 
     abe + ace + ade + abef + acef + adef + abcde + abcdef; 
    beIntersect = 
     abe + bce + bde + abef + bcef + bdef + abcde + abcdef; 
    afIntersect = 
     abf + acf + adf + abef + acef + adef + abcdf + abcdef;
    cfIntersect = 
     acf + bcf + cdf + acef + bcef + cdef + abcdf + abcdef;
    bcIntersect = 
     bc + bce + bcf + bcef + abcd + abcde + abcdf + abcdef;
    
    (-1)^q Binomial[n, 
       q]^(-6) Sum[ (-1)^(aeIntersect + beIntersect + afIntersect + 
           bcIntersect + cfIntersect) n!/(n - 6 q + d2 + 2 d3 + 
           3 d4 + 4 d5 + 5 d6)! 1/(q - ef - abe - ace - ade - bce - 
           bde - cde - abef - acef - adef - bcef - bdef - cdef - 
           abcde - abcdef)! 1/(q - ef - abf - acf - adf - bcf - bdf - 
           cdf - abef - acef - adef - bcef - bdef - cdef - abcdf - 
           abcdef)! 1/(ab! ac! ad! bc! bd! cd! ef!) 1/(
        abe! ace! ade! bce! bde! cde! abf! acf! adf! bcf! bdf! cdf!)
         1/(abcd! abef! acef! adef! bcef! bdef! cdef!) 1/(
        abcde! abcdf!) 1/abcdef! /. solee1234ff1234[q][[i]], {i, 1, 
       Length[solee1234ff1234[q]]}]];

te12e34f13f42[n_, q_] := 
  te12e34f13f42[n, q] = 
   Module[{d2, d3, d4, d5, d6, aeIntersect, beIntersect, afIntersect, 
     bcIntersect, cfIntersect, bdIntersect}, 
    d2 = ab + ac + ad + bc + bd + cd + ef; 
    d3 = abe + ace + ade + bce + bde + cde + abf + acf + adf + bcf + 
      bdf + cdf;
    d4 = abef + acef + adef + bcef + bdef + cdef + abcd; 
    d5 = abcde + abcdf; d6 = abcdef;
    aeIntersect = 
     abe + ace + ade + abef + acef + adef + abcde + abcdef; 
    beIntersect = 
     abe + bce + bde + abef + bcef + bdef + abcde + abcdef; 
    afIntersect = 
     abf + acf + adf + abef + acef + adef + abcdf + abcdef;
    cfIntersect = 
     acf + bcf + cdf + acef + bcef + cdef + abcdf + abcdef;
    bcIntersect = 
     bc + bce + bcf + bcef + abcd + abcde + abcdf + abcdef;
    bdIntersect = 
     bd + bde + bdf + bdef + abcd + abcde + abcdf + abcdef;
    Binomial[n, 
       q]^(-6) Sum[ (-1)^(aeIntersect + beIntersect + afIntersect + 
           bcIntersect + cfIntersect + bdIntersect) n!/(n - 6 q + 
           d2 + 2 d3 + 3 d4 + 4 d5 + 5 d6)! 1/(q - ef - abe - ace - 
           ade - bce - bde - cde - abef - acef - adef - bcef - bdef - 
           cdef - abcde - abcdef)! 1/(q - ef - abf - acf - adf - bcf -
            bdf - cdf - abef - acef - adef - bcef - bdef - cdef - 
           abcdf - abcdef)! 1/(ab! ac! ad! bc! bd! cd! ef!) 1/(
        abe! ace! ade! bce! bde! cde! abf! acf! adf! bcf! bdf! cdf!)
         1/(abcd! abef! acef! adef! bcef! bdef! cdef!) 1/(
        abcde! abcdf!) 1/abcdef! /. solee1234ff1234[q][[i]], {i, 1, 
       Length[solee1234ff1234[q]]}]];


(* {ab,ac,ad,bc,bd,cd,ef,abe,ace,ade,bce,bde,cde,abf,acf,adf,bcf,bdf,\
cdf,abef,acef,adef,bcef,bdef,cdef,abcd,abcde,abcdf,abcdef}*)
(*should \
equal te12e34f13f42*)
te12e34f14f23[n_, q_] := 
  te12e34f14f23[n, q] = 
   Module[{d2, d3, d4, d5, d6, aeIntersect, beIntersect, afIntersect, 
     cdIntersect, bdIntersect, dfIntersect}, 
    d2 = ab + ac + ad + bc + bd + cd + ef; 
    d3 = abe + ace + ade + bce + bde + cde + abf + acf + adf + bcf + 
      bdf + cdf;
    d4 = abef + acef + adef + bcef + bdef + cdef + abcd; 
    d5 = abcde + abcdf; d6 = abcdef;
    aeIntersect = 
     abe + ace + ade + abef + acef + adef + abcde + abcdef; 
    beIntersect = 
     abe + bce + bde + abef + bcef + bdef + abcde + abcdef; 
    afIntersect = 
     abf + acf + adf + abef + acef + adef + abcdf + abcdef;
    dfIntersect = 
     adf + bdf + cdf + adef + bdef + cdef + abcdf + abcdef;
    cdIntersect = 
     cd + cde + cdf + cdef + abcd + abcde + abcdf + abcdef;
    bdIntersect = 
     bd + bde + bdf + bdef + abcd + abcde + abcdf + abcdef;
    Binomial[n, 
       q]^(-6) Sum[ (-1)^(aeIntersect + beIntersect + afIntersect + 
           dfIntersect + cdIntersect + bdIntersect) n!/(n - 6 q + 
           d2 + 2 d3 + 3 d4 + 4 d5 + 5 d6)! 1/(q - ef - abe - ace - 
           ade - bce - bde - cde - abef - acef - adef - bcef - bdef - 
           cdef - abcde - abcdef)! 1/(q - ef - abf - acf - adf - bcf -
            bdf - cdf - abef - acef - adef - bcef - bdef - cdef - 
           abcdf - abcdef)! 1/(ab! ac! ad! bc! bd! cd! ef!) 1/(
        abe! ace! ade! bce! bde! cde! abf! acf! adf! bcf! bdf! cdf!)
         1/(abcd! abef! acef! adef! bcef! bdef! cdef!) 1/(
        abcde! abcdf!) 1/abcdef! /. solee1234ff1234[q][[i]], {i, 1, 
       Length[solee1234ff1234[q]]}]];


(* {ab,ac,ad,bc,bd,cd,ef,abe,ace,ade,bce,bde,cde,abf,acf,adf,bcf,bdf,\
cdf,abef,acef,adef,bcef,bdef,cdef,abcd,abcde,abcdf,abcdef}*)

te12e34f14f32[n_, q_] := 
  te12e34f14f32[n, q] = 
   Module[{d2, d3, d4, d5, d6, aeIntersect, beIntersect, afIntersect, 
     cdIntersect, bdIntersect, bcIntersect, dfIntersect}, 
    d2 = ab + ac + ad + bc + bd + cd + ef; 
    d3 = abe + ace + ade + bce + bde + cde + abf + acf + adf + bcf + 
      bdf + cdf;
    d4 = abef + acef + adef + bcef + bdef + cdef + abcd; 
    d5 = abcde + abcdf; d6 = abcdef;
    aeIntersect = 
     abe + ace + ade + abef + acef + adef + abcde + abcdef; 
    beIntersect = 
     abe + bce + bde + abef + bcef + bdef + abcde + abcdef; 
    afIntersect = 
     abf + acf + adf + abef + acef + adef + abcdf + abcdef;
    dfIntersect = 
     adf + bdf + cdf + adef + bdef + cdef + abcdf + abcdef;
    cdIntersect = 
     cd + cde + cdf + cdef + abcd + abcde + abcdf + abcdef;
    bdIntersect = 
     bd + bde + bdf + bdef + abcd + abcde + abcdf + abcdef;
    bcIntersect = 
     bc + bce + bcf + bcef + abcd + abcde + abcdf + abcdef;
    (-1)^q Binomial[n, 
       q]^(-6) Sum[ (-1)^(aeIntersect + beIntersect + afIntersect + 
           dfIntersect + cdIntersect + bdIntersect + 
           bcIntersect) n!/(n - 6 q + d2 + 2 d3 + 3 d4 + 4 d5 + 
           5 d6)! 1/(q - ef - abe - ace - ade - bce - bde - cde - 
           abef - acef - adef - bcef - bdef - cdef - abcde - 
           abcdef)! 1/(q - ef - abf - acf - adf - bcf - bdf - cdf - 
           abef - acef - adef - bcef - bdef - cdef - abcdf - 
           abcdef)! 1/(ab! ac! ad! bc! bd! cd! ef!) 1/(
        abe! ace! ade! bce! bde! cde! abf! acf! adf! bcf! bdf! cdf!)
         1/(abcd! abef! acef! adef! bcef! bdef! cdef!) 1/(
        abcde! abcdf!) 1/abcdef! /. solee1234ff1234[q][[i]], {i, 1, 
       Length[solee1234ff1234[q]]}]];


(*{ab,ac,ad,ae,af,bc,bd,be,bf,cd,ce,cf,de,df,ef,abcd,abce,abcf,abde,\
abdf,abef,acde,acdf,acef,adef,bcde,bcdf,bcef,bdef,cdef,abcdef}*)

sol123456123456[q_] := 
  sol123456123456[q] = 
   Solve[ab + ac + ad + ae + af + abcd + abce + abcf + abde + abdf + 
       abef + acde + acdf + acef + adef + abcdef == q && 
     ab + bc + bd + be + bf + abcd + abce + abcf + abde + abdf + 
       abef + bcde + bcdf + bcef + bdef + abcdef == q && 
     ac + bc + cd + ce + cf + abcd + abce + abcf + acde + acdf + 
       acef + bcde + bcdf + bcef + cdef + abcdef == q && 
     Plus[ad, bd, cd, de, df, abcd, abde, abdf, acde, acde, adef, 
       bcde, bcdf, bdef, cdef, abcdef] == q && 
     Plus[ae, be, ce, de, ef, abce, abde, abef, acde, acef, adef, 
       bcde, bcef, bdef, cdef, abcdef] == q && 
     Plus[af, bf, cf, df, ef, abcf, abdf, abef, acdf, acef, adef, 
       bcdf, bcef, bdef, cdef, abcdef] == q && 0 <= ab <= q && 
     0 <= ac <= q && 0 <= ad <= q && 0 <= ae <= q && 0 <= af <= q && 
     0 <= bc <= q && 0 <= bd <= q && 0 <= be <= q && 0 <= bf <= q && 
     0 <= cd <= q && 0 <= ce <= q && 0 <= cf <= q && 0 <= de <= q && 
     0 <= df <= q && 0 <= ef <= q && 0 <= abcd <= q && 
     0 <= abce <= q && 0 <= abcf <= q && 0 <= abde <= q && 
     0 <= abdf <= q && 0 <= abef <= q && 0 <= acde <= q && 
     0 <= acdf <= q && 0 <= acef <= q && 0 <= adef <= q && 
     0 <= bcde <= q && 0 <= bcdf <= q && 0 <= bcef <= q && 
     0 <= bdef <= q && 0 <= cdef <= q && 0 <= abcdef <= q, {ab, ac, 
     ad, ae, af, bc, bd, be, bf, cd, ce, cf, de, df, ef, abcd, abce, 
     abcf, abde, abdf, abef, acde, acdf, acef, adef, bcde, bcdf, bcef,
      bdef, cdef, abcdef}];


t123456123456[n_, q_] := 
  t123456123456[n, q] = 
   Module[{d2, d4, d6}, 
    d2 = Plus[ab, ac, ad, ae, af, bc, bd, be, bf, cd, ce, cf, de, df, 
      ef]; d4 = 
     Plus[abcd, abce, abcf, abde, abdf, abef, acde, acdf, acef, adef, 
      bcde, bcdf, bcef, bdef, cdef]; d6 = abcdef;
    Binomial[n, q]^(-6) Sum[ 
      n!/(n - 6 q + d2 + 3 d4 + 5 d6)! 1/(
        ab! ac! ad! ae! af! bc! bd! be! bf! cd! ce! cf! de! df! ef!)
         1/(abcd! abce! abcf! abde! abdf! abef! acde! acdf! acef! \
adef! bcde! bcdf! bcef! bdef! cdef!) 1/abcdef! /. 
       sol123456123456[q][[i]], {i, 1, Length[sol123456123456[q]]}]];

ttr33[n_, q_] := 3 (1 + (-1)^Binomial[q, 2]) t123123[n, q];
ttr44[n_, q_] := (1 + 8/Binomial[n, q]) mom4[n, q]^2 + 
   8 t12341234[n, q] + 16 t12341243[n, q];
ttr35[n_, q_] := 
  15 (1 + et[n, q]) (1 + (-1)^Binomial[q, 2]) t123123[n, q];
ttr46[n_, q_] := (1 + 12/Binomial[n, q]) mom4[n, q] mom6[n, q] + 
   6 (1 + et[n, q]) (8 t12341234[n, q] + 16 t12341243[n, q]) + 
   3*8 (t1234e12e34[n, q] + t1234e12e43[n, q] + t1234e13e24[n, q]);
ttr55[n_, q_] := 
  3*25 (1 + (-1)^Binomial[q, 2]) (1 + et[n, q])^2 t123123[n, q] + 
   5 (1 + (-1)^Binomial[q, 2]) (t1234512345[n, q] + 
      5 t1234512354[n, q] + 5 t1234512453[n, q] + t1234513524[n, q]);

